---
title: Emo Artistic Image Generation App Development
created_at: 2019-12-11
updated_at: null
date: 2019-12-11
type: tech
image: /img/tech.jpg
description: Developed an app to convert your favorite images into mosaic art with text.
tags:
  - Javascript
  - p5.js
---

This article is the 11th day of [DeNA Advent Calendar 2019](https://qiita.com/advent-calendar/2019/dena).

Please also support [DeNA 20 New Graduates Advent Calendar 2019](https://qiita.com/advent-calendar/2019/dena-20-shinsostu).

`Please note: The content of this article is a private learning article and has nothing to do with my work at DeNA. `


## The application we created this time

**„ÄêEmoEmo Art„Äë**

‚Üì‚Üì I'll play it from here! ‚Üì‚Üì‚Üì

https://p5js.tech/

### What can I do with this app?

You can display an original image on canvas with text based on the uploaded image.

**„ÄêImages generated by the application„Äë**

It can generate images that look like mosaic art.

`‚ÜìSamples‚Üì`.

![191211_144858_971.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/199085/9a5276e4-d5e9-9cd6-a4bd-2e96b4e578ef.png)

`‚ÜìIf you zoom in...‚Üì`

In fact, if you zoom in and look closely, you can see the English text here.

<img
alt="„Çπ„ÇØ„É™„Éº„É≥„Ç∑„Éß„ÉÉ„Éà 2019-12-11 15.04.37.png"
src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/199085/183289be-362b-1fcc-fbbf-a19efcc7855f.png">

I'm using text data from the beginning of Shakespeare's Hamlet (a public domain work) to generate an image in canvas.

If you strain your eyes, you can read it from the upper left corner.

This application can generate an original emo image based on the text data and image.

## How I implemented this app.

## How it all started

I was wandering around a bookstore on my day off and somehow found this on the architecture shelf [Generative Design with p5.js]

I found [p5.js for generative design](http://www.bnn.co.jp/books/9296/) and was interested in this framework because I had never heard of p5.js before. I was interested to learn that such a framework existed.

### Day 1 Introduction

#### Buy a p5js book and do various tutorials.

I suppressed the urge to implement it out of the blue and read the documentation. It is important to read the documentation properly.

Learn how to use it by reading the explanations in the book.

I enjoyed learning from the wide variety of samples.

[Sample Code](http://www.bnn.co.jp/support/generativedesign_p5js/)

Among the samples, the ability to convert image pixels into color text was interesting, and I wanted to use this feature to create something. There is also an editor, so I can read it as I go.

[Sample code (P_4_3_2_01) and editor](https://editor.p5js.org/generative-design/sketches/P_4_3_2_01)

### Day 2 Implementation begins.

#### First, decide what kind of app you want to use.

12/09(Mon)

1. The sample is fixed to one type of image, so you can choose the image you want.
2. Allow saving the generated image.
3. I want to be able to share the generated images.

#### Allow you to choose the image you want.

The first step is to implement the image so that it can be generated using an image of your choice.
Since the selected image cannot be retrieved without waiting for the loading to be completed, I devised a way to get the elements of the image.

1. Select an image
2. Load an image
3. Determine the size of the canvas based on the information of the loaded image elements.
4. Generate in canvas

- If the image size is too large, the canvas becomes too large.
  - If the image size is too large, it will overflow the screen.
- If you are using a smartphone, the canvas generation process will take too much time.

Therefore, if the image is too large, the canvas size is calculated based on the image size and screen size.
If the image is too large, the canvas size will be calculated based on the image size and screen size, and generated so that the aspect ratio is not broken.

```javascript
if (window.innerWidth < image.width) {
  const set = Math.floor(window.innerWidth / image.width * 100) / 100;
  setup(image.width * set, image.height * set);
} else {
  setup(image.width, image.height);
}
```

Just this simple response has made it much easier to use ^^.

#### Allows users to change text size and other settings as they see fit.

This function was originally only available on PCs in p5js, so we ported it to smartphones.

It was originally designed to be used on PCs, so basically the processing for smartphones was done by reading the code for the PC implementation.

You can read the code for the PC implementation and implement the functions for smartphones.

#### Enables to save the generated image

Ported the function to save the canvas as an image, which was a PC-only function, so that it can be used on smartphones as well.

So far, the app has almost met the basic requirements.

But...`but...`.

**It's just very difficult to use with the current screen...**.

I'm a developer, and I can use it, but it's hard for first time users to use it.

<img alt="Êñá‰∏≠„ÅÆËß£Ë™¨ÁîªÂÉè" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/199085/4656b746-93cd-9daa-d5e7-00f8c0e773db.png" width=50%>

**...this is awful!

`And...`

‚Üì Here is the original picture I took when I walked to Tokyo Tower the other day.

<img alt="Êñá‰∏≠„ÅÆËß£Ë™¨ÁîªÂÉè" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/199085/8cdd7d56-4669-7db6-d771-289ca8d092e2.jpeg" width=50%>

~~I think the original image is better for some reason.~~

**Ôºà„ÄÄÔæü –îÔæüÔºâ‚ÄºÔ∏è**üí°

Yeah.

**It's not emo enough.ÔºÅÔºÅ**

„ÄêConclusion„Äë

**We can make it more emo by allowing users to tweak the font size and other settings as they wish.**

### Day 3 Make it easy to use

#### Add features and brush up.

[Brush-up 1] Allowing you to change text size as you like

Allowing users to freely change the size of text

Implemented the ability to freely change the maximum and minimum size of the text so that the text can be varied.

In addition, the current font size is displayed and can be fine-tuned for a more emotive feel.

#### [Brush-up 2] Monochrome mode support

Change the text from color to monochrome.

There are some cases where color is not enough, so I thought it would be better to change the text to monochrome to make it look like an English newspaper and express emotions.

<img alt="Êñá‰∏≠„ÅÆËß£Ë™¨ÁîªÂÉè" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/199085/18b79824-bcb9-17d8-de60-af5f4a30f9cd.png" width=50%>

#### [Brush-up 3] Adjusting the UI of the app

Since there are no more additional features, I adjusted the UI for the last time.

I think it was the right decision to leave it for last, because the UI idea changed a lot in my mind as I implemented it.

![„Çπ„ÇØ„É™„Éº„É≥„Ç∑„Éß„ÉÉ„Éà 2019-12-11 12.34.49.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/199085/dd549ab8-8956-de0f-b487-8f43164667ea.png)

(Sense notwithstanding) I could easily change the canvas on my phone!

### Other minor support.

- Go get a server, get a domain.
- HTTPS support
- Add analytics, etc.

## Summary

I found this book by chance and was able to proceed to create a simple application.

I was able to reconfirm that it's fun to be able to give shape to an idea that you've thought of and release it to the world.

It hasn't been long since I became an engineer, so I would like to continue learning and improving my technical skills every day so that I can give shape to the ideas that come to mind.

### Suggested features I wanted to add to Emoemo Art

~~I've been slacking off until the 9th, just before posting the advent calendar.

Here is a list of features I wanted to add, but I had to skip them due to time constraints

- SNS share function such as twitter
  - Allow users to share and post images
  - For Instagram, etc., the ability to share with a specific hashtag.
- Canvas background color change
  - This could also be changed dynamically by connecting it.
- Ability to add labels
  - It would be interesting to be able to add LGTM or favorite images at the end.
- Loading display
  - I would like to add this because it's not very friendly to users since they don't see any changes while loading.

If you have any ideas for this app, please comment here. If you have any ideas, please feel free to comment on this article.

Thank you for reading to the end.

**[Emoemo Art]**.

‚Üì‚Üì Try to play from here! ‚Üì‚Üì‚Üì‚Üì

https://p5js.tech/
